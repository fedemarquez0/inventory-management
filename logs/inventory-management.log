2025-10-08 17:55:34 [restartedMain] INFO  c.m.i.InventoryManagementApplication - Starting InventoryManagementApplication using Java 21.0.8 with PID 35092 (C:\Users\fedem\Documents\Github\inventory-management\target\classes started by fedem in C:\Users\fedem\Documents\Github\inventory-management)
2025-10-08 17:55:34 [restartedMain] DEBUG c.m.i.InventoryManagementApplication - Running with Spring Boot v3.5.6, Spring v6.2.11
2025-10-08 17:55:34 [restartedMain] INFO  c.m.i.InventoryManagementApplication - No active profile set, falling back to 1 default profile: "default"
2025-10-08 17:55:34 [restartedMain] INFO  o.s.b.d.e.DevToolsPropertyDefaultsPostProcessor - Devtools property defaults active! Set 'spring.devtools.add-properties' to 'false' to disable
2025-10-08 17:55:34 [restartedMain] INFO  o.s.b.d.e.DevToolsPropertyDefaultsPostProcessor - For additional web related logging consider setting the 'logging.level.web' property to 'DEBUG'
2025-10-08 17:55:36 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data R2DBC repositories in DEFAULT mode.
2025-10-08 17:55:36 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 129 ms. Found 4 R2DBC repository interfaces.
2025-10-08 17:55:37 [restartedMain] INFO  o.s.b.d.a.OptionalLiveReloadServer - LiveReload server is running on port 35729
2025-10-08 17:55:37 [restartedMain] INFO  c.m.i.i.config.R2dbcConfig - Database initialization configured
2025-10-08 17:55:38 [single-1] DEBUG io.r2dbc.h2.client.SessionClient - Request:  CALL H2VERSION()
2025-10-08 17:55:38 [single-1] DEBUG io.r2dbc.h2.client.SessionClient - Response: org.h2.result.LocalResult@9959b6 columns: 1 rows: 1 pos: -1
2025-10-08 17:55:38 [single-1] DEBUG io.r2dbc.pool.ConnectionPool - Obtaining new connection from the pool
2025-10-08 17:55:38 [single-1] DEBUG io.r2dbc.h2.client.SessionClient - Request:  SELECT CURRENT_TIMESTAMP
2025-10-08 17:55:38 [single-1] DEBUG io.r2dbc.h2.client.SessionClient - Response: org.h2.result.LocalResult@62b835c7 columns: 1 rows: 1 pos: -1
2025-10-08 17:55:38 [single-1] DEBUG io.r2dbc.h2.client.SessionClient - Request:  CALL H2VERSION()
2025-10-08 17:55:38 [single-1] DEBUG io.r2dbc.h2.client.SessionClient - Response: org.h2.result.LocalResult@799b04bf columns: 1 rows: 1 pos: -1
2025-10-08 17:55:38 [single-1] DEBUG io.r2dbc.h2.client.SessionClient - Request:  CALL H2VERSION()
2025-10-08 17:55:38 [single-1] DEBUG io.r2dbc.h2.client.SessionClient - Response: org.h2.result.LocalResult@61bb2e46 columns: 1 rows: 1 pos: -1
2025-10-08 17:55:38 [single-1] DEBUG io.r2dbc.h2.client.SessionClient - Request:  CALL H2VERSION()
2025-10-08 17:55:38 [single-1] DEBUG io.r2dbc.h2.client.SessionClient - Response: org.h2.result.LocalResult@496d71cd columns: 1 rows: 1 pos: -1
2025-10-08 17:55:38 [single-1] DEBUG io.r2dbc.h2.client.SessionClient - Request:  CALL H2VERSION()
2025-10-08 17:55:38 [single-1] DEBUG io.r2dbc.h2.client.SessionClient - Response: org.h2.result.LocalResult@5d9504e0 columns: 1 rows: 1 pos: -1
2025-10-08 17:55:38 [single-1] DEBUG io.r2dbc.h2.client.SessionClient - Request:  CALL H2VERSION()
2025-10-08 17:55:38 [single-1] DEBUG io.r2dbc.h2.client.SessionClient - Response: org.h2.result.LocalResult@7c8a5d11 columns: 1 rows: 1 pos: -1
2025-10-08 17:55:38 [Thread-18] DEBUG io.r2dbc.h2.client.SessionClient - Request:  DROP TABLE IF EXISTS inventory
2025-10-08 17:55:38 [single-1] DEBUG io.r2dbc.h2.client.SessionClient - Request:  CALL H2VERSION()
2025-10-08 17:55:38 [single-1] DEBUG io.r2dbc.h2.client.SessionClient - Response: org.h2.result.LocalResult@447b85d8 columns: 1 rows: 1 pos: -1
2025-10-08 17:55:38 [single-1] DEBUG io.r2dbc.h2.client.SessionClient - Request:  CALL H2VERSION()
2025-10-08 17:55:38 [single-1] DEBUG io.r2dbc.h2.client.SessionClient - Response: org.h2.result.LocalResult@663a7783 columns: 1 rows: 1 pos: -1
2025-10-08 17:55:38 [Thread-18] DEBUG io.r2dbc.h2.client.SessionClient - Request:  DROP TABLE IF EXISTS user_store_permissions
2025-10-08 17:55:38 [Thread-18] DEBUG io.r2dbc.h2.client.SessionClient - Request:  DROP TABLE IF EXISTS products
2025-10-08 17:55:38 [single-1] DEBUG io.r2dbc.h2.client.SessionClient - Request:  CALL H2VERSION()
2025-10-08 17:55:38 [single-1] DEBUG io.r2dbc.h2.client.SessionClient - Response: org.h2.result.LocalResult@13fddda0 columns: 1 rows: 1 pos: -1
2025-10-08 17:55:38 [Thread-18] DEBUG io.r2dbc.h2.client.SessionClient - Request:  DROP TABLE IF EXISTS stores
2025-10-08 17:55:38 [single-1] DEBUG io.r2dbc.h2.client.SessionClient - Request:  CALL H2VERSION()
2025-10-08 17:55:38 [single-1] DEBUG io.r2dbc.h2.client.SessionClient - Response: org.h2.result.LocalResult@3db1781b columns: 1 rows: 1 pos: -1
2025-10-08 17:55:38 [Thread-18] DEBUG io.r2dbc.h2.client.SessionClient - Request:  DROP TABLE IF EXISTS users
2025-10-08 17:55:38 [Thread-18] DEBUG io.r2dbc.h2.client.SessionClient - Request:  CREATE TABLE IF NOT EXISTS products ( id BIGINT AUTO_INCREMENT PRIMARY KEY, sku VARCHAR(50) NOT NULL UNIQUE, name VARCHAR(200) NOT NULL, description VARCHAR(500), is_active BOOLEAN NOT NULL DEFAULT TRUE, created_at TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP, updated_at TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP )
2025-10-08 17:55:38 [Thread-18] DEBUG io.r2dbc.h2.client.SessionClient - Request:  CREATE TABLE IF NOT EXISTS stores ( id BIGINT AUTO_INCREMENT PRIMARY KEY, name VARCHAR(100) NOT NULL UNIQUE, is_active BOOLEAN NOT NULL DEFAULT TRUE, created_at TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP, updated_at TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP )
2025-10-08 17:55:38 [Thread-18] DEBUG io.r2dbc.h2.client.SessionClient - Request:  CREATE TABLE IF NOT EXISTS users ( id BIGINT AUTO_INCREMENT PRIMARY KEY, username VARCHAR(50) NOT NULL UNIQUE, password_hash VARCHAR(255) NOT NULL, role VARCHAR(20) NOT NULL, is_active BOOLEAN NOT NULL DEFAULT TRUE, created_at TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP, updated_at TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP )
2025-10-08 17:55:38 [Thread-18] DEBUG io.r2dbc.h2.client.SessionClient - Request:  CREATE TABLE IF NOT EXISTS inventory ( id BIGINT AUTO_INCREMENT PRIMARY KEY, product_id BIGINT NOT NULL, store_id BIGINT NOT NULL, available_qty INT NOT NULL DEFAULT 0, version INT NOT NULL DEFAULT 0, updated_at TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP, FOREIGN KEY (product_id) REFERENCES products(id), FOREIGN KEY (store_id) REFERENCES stores(id), UNIQUE(product_id, store_id) )
2025-10-08 17:55:38 [Thread-18] DEBUG io.r2dbc.h2.client.SessionClient - Request:  CREATE TABLE IF NOT EXISTS user_store_permissions ( id BIGINT AUTO_INCREMENT PRIMARY KEY, user_id BIGINT NOT NULL, store_id BIGINT NOT NULL, FOREIGN KEY (user_id) REFERENCES users(id), FOREIGN KEY (store_id) REFERENCES stores(id), UNIQUE(user_id, store_id) )
2025-10-08 17:55:38 [Thread-18] DEBUG io.r2dbc.h2.client.SessionClient - Request:  CREATE INDEX IF NOT EXISTS idx_inventory_product_id ON inventory(product_id)
2025-10-08 17:55:38 [Thread-18] DEBUG io.r2dbc.h2.client.SessionClient - Request:  CREATE INDEX IF NOT EXISTS idx_inventory_store_id ON inventory(store_id)
2025-10-08 17:55:38 [Thread-18] DEBUG io.r2dbc.h2.client.SessionClient - Request:  CREATE INDEX IF NOT EXISTS idx_user_store_permissions_user_id ON user_store_permissions(user_id)
2025-10-08 17:55:38 [Thread-18] DEBUG io.r2dbc.h2.client.SessionClient - Request:  CREATE INDEX IF NOT EXISTS idx_user_store_permissions_store_id ON user_store_permissions(store_id)
2025-10-08 17:55:38 [Thread-18] DEBUG io.r2dbc.h2.client.SessionClient - Request:  CREATE INDEX IF NOT EXISTS idx_products_sku ON products(sku)
2025-10-08 17:55:38 [Thread-18] DEBUG io.r2dbc.h2.client.SessionClient - Request:  CREATE INDEX IF NOT EXISTS idx_users_username ON users(username)
2025-10-08 17:55:38 [Thread-18] DEBUG io.r2dbc.h2.client.SessionClient - Request:  INSERT INTO stores (id, name, is_active, created_at, updated_at) VALUES (1, 'Shopping Dinosaurio Mall', TRUE, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP), (2, 'Centro Maipu 712', TRUE, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP), (3, 'Nuevo Centro Shopping', TRUE, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP)
2025-10-08 17:55:38 [Thread-18] DEBUG io.r2dbc.h2.client.SessionClient - Request:  INSERT INTO users (id, username, password_hash, role, is_active, created_at, updated_at) VALUES (1, 'admin', '$2a$10$64K/otiwP59MWSCrAWD8XezUo5l.v5k0X9zaV3S8NqKKbabW72WEa', 'ADMIN', TRUE, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP), (2, 'user_dinosaurio', '$2a$10$64K/otiwP59MWSCrAWD8XezUo5l.v5k0X9zaV3S8NqKKbabW72WEa', 'STORE_USER', TRUE, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP), (3, 'user_maipu', '$2a$10$64K/otiwP59MWSCrAWD8XezUo5l.v5k0X9zaV3S8NqKKbabW72WEa', 'STORE_USER', TRUE, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP), (4, 'user_nuevo_centro', '$2a$10$64K/otiwP59MWSCrAWD8XezUo5l.v5k0X9zaV3S8NqKKbabW72WEa', 'STORE_USER', TRUE, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP)
2025-10-08 17:55:38 [Thread-18] DEBUG io.r2dbc.h2.client.SessionClient - Request:  INSERT INTO user_store_permissions (id, user_id, store_id) VALUES (1, 2, 1), (2, 3, 2), (3, 4, 3)
2025-10-08 17:55:38 [Thread-18] DEBUG io.r2dbc.h2.client.SessionClient - Request:  INSERT INTO products (id, sku, name, description, is_active, created_at, updated_at) VALUES (1, 'REM-001-BL-M', 'Remera Básica Blanca M', 'Remera de algodón peinado 160gsm', TRUE, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP), (2, 'REM-002-NG-L', 'Remera Básica Negra L', 'Remera cuello redondo negra', TRUE, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP), (3, 'REM-003-AZ-S', 'Remera Azul S', 'Remera azul marino corte clásico', TRUE, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP), (4, 'BUZ-001-GR-M', 'Buzo Hoodie Gris M', 'Buzo frisa liviano con capucha', TRUE, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP), (5, 'BUZ-002-NG-L', 'Buzo Hoodie Negro L', 'Buzo de algodón grueso con bolsillo canguro', TRUE, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP), (6, 'PAN-001-NG-32', 'Pantalón Chino Negro 32', 'Pantalón tipo chino con elastano', TRUE, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP), (7, 'PAN-002-AZ-34', 'Jeans Azul 34', 'Jeans corte slim fit azul oscuro', TRUE, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP), (8, 'BER-001-KH-M', 'Bermuda Cargo Khaki M', 'Bermuda con bolsillos laterales', TRUE, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP), (9, 'BER-002-AZ-L', 'Bermuda Denim Azul L', 'Bermuda de jean azul clásico', TRUE, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP), (10, 'CAM-001-BL-M', 'Camisa Blanca Oxford M', 'Camisa manga larga oxford blanco', TRUE, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP), (11, 'CAM-002-CE-L', 'Camisa Celeste L', 'Camisa de poplin celeste claro', TRUE, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP), (12, 'CMP-001-NG-M', 'Campera Rompeviento Negra M', 'Campera liviana impermeable con cierre', TRUE, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP), (13, 'CMP-002-AZ-L', 'Campera Puffer Azul L', 'Campera acolchada pluma sintética', TRUE, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP), (14, 'ZAP-001-NG-42', 'Zapatillas Urbanas Negras 42', 'Zapatillas urbanas con suela EVA', TRUE, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP), (15, 'ZAP-002-BL-41', 'Zapatillas Running Blancas 41', 'Zapatillas deportivas livianas', TRUE, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP), (16, 'GOR-001-NG-U', 'Gorra Negra U', 'Gorra ajustable negra con visera curva', TRUE, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP), (17, 'MED-001-BL-U', 'Pack Medias Blancas U', 'Pack x3 medias tobillera blancas', TRUE, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP)
2025-10-08 17:55:38 [Thread-18] DEBUG io.r2dbc.h2.client.SessionClient - Request:  INSERT INTO inventory (id, product_id, store_id, available_qty, version, updated_at) VALUES (1, 1, 1, 25, 0, CURRENT_TIMESTAMP), (2, 1, 2, 18, 0, CURRENT_TIMESTAMP), (3, 1, 3, 35, 0, CURRENT_TIMESTAMP), (4, 2, 1, 20, 0, CURRENT_TIMESTAMP), (5, 2, 2, 15, 0, CURRENT_TIMESTAMP), (6, 2, 3, 30, 0, CURRENT_TIMESTAMP), (7, 3, 1, 14, 0, CURRENT_TIMESTAMP), (8, 3, 2, 22, 0, CURRENT_TIMESTAMP), (9, 3, 3, 28, 0, CURRENT_TIMESTAMP), (10, 4, 1, 10, 0, CURRENT_TIMESTAMP), (11, 4, 2, 12, 0, CURRENT_TIMESTAMP), (12, 4, 3, 20, 0, CURRENT_TIMESTAMP), (13, 5, 1, 8, 0, CURRENT_TIMESTAMP), (14, 5, 2, 11, 0, CURRENT_TIMESTAMP), (15, 5, 3, 16, 0, CURRENT_TIMESTAMP), (16, 6, 1, 12, 0, CURRENT_TIMESTAMP), (17, 6, 2, 10, 0, CURRENT_TIMESTAMP), (18, 6, 3, 18, 0, CURRENT_TIMESTAMP), (19, 7, 1, 14, 0, CURRENT_TIMESTAMP), (20, 7, 2, 13, 0, CURRENT_TIMESTAMP), (21, 7, 3, 22, 0, CURRENT_TIMESTAMP), (22, 8, 1, 16, 0, CURRENT_TIMESTAMP), (23, 8, 2, 12, 0, CURRENT_TIMESTAMP), (24, 8, 3, 24, 0, CURRENT_TIMESTAMP), (25, 9, 1, 10, 0, CURRENT_TIMESTAMP), (26, 9, 2, 14, 0, CURRENT_TIMESTAMP), (27, 9, 3, 20, 0, CURRENT_TIMESTAMP), (28, 10, 1, 11, 0, CURRENT_TIMESTAMP), (29, 10, 2, 10, 0, CURRENT_TIMESTAMP), (30, 10, 3, 19, 0, CURRENT_TIMESTAMP), (31, 11, 1, 9, 0, CURRENT_TIMESTAMP), (32, 11, 2, 12, 0, CURRENT_TIMESTAMP), (33, 11, 3, 18, 0, CURRENT_TIMESTAMP), (34, 12, 1, 6, 0, CURRENT_TIMESTAMP), (35, 12, 2, 7, 0, CURRENT_TIMESTAMP), (36, 12, 3, 12, 0, CURRENT_TIMESTAMP), (37, 13, 1, 5, 0, CURRENT_TIMESTAMP), (38, 13, 2, 6, 0, CURRENT_TIMESTAMP), (39, 13, 3, 10, 0, CURRENT_TIMESTAMP), (40, 14, 1, 8, 0, CURRENT_TIMESTAMP), (41, 14, 2, 10, 0, CURRENT_TIMESTAMP), (42, 14, 3, 15, 0, CURRENT_TIMESTAMP), (43, 15, 1, 7, 0, CURRENT_TIMESTAMP), (44, 15, 2, 9, 0, CURRENT_TIMESTAMP), (45, 15, 3, 14, 0, CURRENT_TIMESTAMP), (46, 16, 1, 20, 0, CURRENT_TIMESTAMP), (47, 16, 2, 18, 0, CURRENT_TIMESTAMP), (48, 16, 3, 30, 0, CURRENT_TIMESTAMP), (49, 17, 1, 35, 0, CURRENT_TIMESTAMP), (50, 17, 2, 28, 0, CURRENT_TIMESTAMP), (51, 17, 3, 50, 0, CURRENT_TIMESTAMP)
2025-10-08 17:55:38 [Thread-18] DEBUG io.r2dbc.pool.PooledConnection - Releasing connection
2025-10-08 17:55:38 [Thread-18] DEBUG io.r2dbc.h2.client.SessionClient - Request:  SELECT CURRENT_TIMESTAMP
2025-10-08 17:55:38 [Thread-18] DEBUG io.r2dbc.h2.client.SessionClient - Response: org.h2.result.LocalResult@6602a4fa columns: 1 rows: 1 pos: -1
2025-10-08 17:55:38 [restartedMain] INFO  o.s.b.a.s.r.ReactiveUserDetailsServiceAutoConfiguration - 

Using generated security password: 136d6409-f7a2-4207-bc5e-6eaf88938d8f

2025-10-08 17:55:38 [restartedMain] INFO  o.s.b.a.e.web.EndpointLinksResolver - Exposing 4 endpoints beneath base path '/actuator'
2025-10-08 17:55:39 [restartedMain] INFO  o.s.b.w.e.netty.NettyWebServer - Netty started on port 8080 (http)
2025-10-08 17:55:39 [restartedMain] INFO  c.m.i.InventoryManagementApplication - Started InventoryManagementApplication in 4.905 seconds (process running for 11.834)
2025-10-08 17:55:41 [parallel-3] INFO  o.s.api.AbstractOpenApiResource - Init duration for springdoc-openapi is: 260 ms
2025-10-08 17:56:02 [parallel-4] DEBUG io.r2dbc.pool.ConnectionPool - Obtaining new connection from the pool
2025-10-08 17:56:02 [parallel-4] DEBUG io.r2dbc.h2.client.SessionClient - Request:  SELECT CURRENT_TIMESTAMP
2025-10-08 17:56:02 [parallel-4] DEBUG io.r2dbc.h2.client.SessionClient - Response: org.h2.result.LocalResult@1055221d columns: 1 rows: 1 pos: -1
2025-10-08 17:56:02 [parallel-4] DEBUG io.r2dbc.h2.client.SessionClient - Request:  SELECT CURRENT_TIMESTAMP
2025-10-08 17:56:02 [parallel-4] DEBUG io.r2dbc.h2.client.SessionClient - Response: org.h2.result.LocalResult@2b8c7c7e columns: 1 rows: 1 pos: -1
2025-10-08 17:56:02 [parallel-4] DEBUG io.r2dbc.pool.PooledConnection - Releasing connection
2025-10-08 17:56:02 [parallel-4] DEBUG io.r2dbc.h2.client.SessionClient - Request:  SELECT CURRENT_TIMESTAMP
2025-10-08 17:56:02 [parallel-4] DEBUG io.r2dbc.h2.client.SessionClient - Response: org.h2.result.LocalResult@35549661 columns: 1 rows: 1 pos: -1
2025-10-08 19:00:25 [SpringApplicationShutdownHook] INFO  o.s.b.w.e.netty.GracefulShutdown - Commencing graceful shutdown. Waiting for active requests to complete
2025-10-08 19:00:25 [netty-shutdown] INFO  o.s.b.w.e.netty.GracefulShutdown - Graceful shutdown complete
